<div class="mainwindow">
    <div class="content_window">        
        <div class="flexorientation--spaceb">            
            <h2>{{process.title}}</h2>
            <small>{{process.date}}</small>
        </div>        
        <hr>       
        <div id="list">
            {{#if documents}}
            {{else}}
            <p>NÃ£o existem documentos dentro deste processo.</p>
            {{/if}}
        </div>               
        <hr>        
        <div class="display-float-right">
            <small>Status</small>
            <button class="button" id="statusbutton">+</button>
        </div>
        <div id="states">            
        </div>            
        <form id="upload">
            <label for="file" class="button_file" id="button_file">Upload</label>
            <input type="file" id="file" name="file" value="" required>
            <span id="filename"></span required>            
        </form>
        <br>
        <p id="message"></p>
        {{#if error}}        
        <p>{{error}}</p>        
        {{/if}}
        <div class="flexorientation--spaceb">
            <div class="arrow">
                <a href="/meusprocessos/"><img src="/img/seta2.png" style="height: 20px; width: 20px;"></a>
            </div>
            <form id="sendprocess">
            </form>
        </div>
    </div>
</div>


<script src="/js/document_reader/readerFile.js"></script>
<script>  
    const list = document.getElementById('list');    
    const names = [];
    let states = [];
    const transfer =  '{{process.transfer_dir}}' || null;
    const done = '{{process.done_dir}}' || null    
    '{{#each documents}}'
    names.push({
        name:'{{name}}'        
        });        
    '{{/each}}'

    '{{#if states}}'
    '{{#each states}}'
    states.push({
        id: '{{_id}}',
        state: '{{state}}',
        anotation: '{{anotation}}',
        date: '{{date}}'
    });    
    '{{/each}}'
    '{{/if}}'
     
    listReader(list, names, `/meusprocessos/{{process.year}}/{{process.user_dir}}/`, transfer, done);
    listStates(states, '{{process.title}}', `/meusprocessos/{{process.year}}/{{process.user_dir}}/`, transfer, done);
    upload('inProcess', `/meusprocessos/{{process.year}}/{{process.user_dir}}/`, transfer , done);
    sendProcess('{{process._id}}', '{{process.title}}', '{{process.year}}', transfer, done);
</script> 
